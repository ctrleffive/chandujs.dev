{"componentChunkName":"component---src-templates-blog-js","path":"/blog/static-website-hosting-with-github-actions-4g0d/","result":{"data":{"devArticles":{"article":{"title":"üìô Static Website Hosting With GitHub & Actions","slug":"static-website-hosting-with-github-actions-4g0d","description":"My website chandujs.dev is made with Gatsby. I made an article in dev.to recently. Read it here....","tags":["github","gatsby","hosting"],"readable_publish_date":"Apr 8 '20","body_html":"<p>My website chandujs.dev is made with Gatsby. I made an article in dev.to recently. Read it <a href=\"https://chandujs.dev/blog/i-made-my-website-with-gatsby-54jk\">here</a>.</p>\n\n\n<div class=\"ltag__link\">\n  <a href=\"/ctrleffive\" class=\"ltag__link__link\">\n    <div class=\"ltag__link__pic\">\n      <img src=\"https://res.cloudinary.com/practicaldev/image/fetch/s--1GMLvIIy--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://res.cloudinary.com/practicaldev/image/fetch/s--LKcmzzhL--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/61261/7d63301a-4388-4a48-937b-3e9a2ba3181d.jpg\" alt=\"ctrleffive image\" loading=\"lazy\">\n    </div>\n  </a>\n  <a href=\"/ctrleffive/i-made-my-website-with-gatsby-54jk\" class=\"ltag__link__link\">\n    <div class=\"ltag__link__content\">\n      <h2>üåè I Made My Website With Gatsby!</h2>\n      <h3>Chandu J S „Éª Feb 21 „Éª 3 min read</h3>\n      <div class=\"ltag__link__taglist\">\n        <span class=\"ltag__link__tag\">#gatsby</span>\n        <span class=\"ltag__link__tag\">#portfolio</span>\n        <span class=\"ltag__link__tag\">#javascript</span>\n        <span class=\"ltag__link__tag\">#webdev</span>\n      </div>\n    </div>\n  </a>\n</div>\n\n\n<p>I was using Netlify for hosting my website. Then I thought, why not use GitHub pages to host my website for free? Netlify is an awesome service, I know. But I have a problem keeping things in different places. GitHub has everything I want to host my website.</p>\n\n<p><strong>Reasons to Choose GitHub</strong></p>\n\n<ul>\n<li>GitHub Pages for hosting.</li>\n<li>GitHub Actions for building &amp; deploying.</li>\n<li>Since my website is in a public repo, Hosting with GitHub pages is free, running GitHub Actions won't count against the 2,000 minutes per month quota.</li>\n<li>Webhooks for triggering actions are available,  <a href=\"https://help.github.com/en/actions/reference/events-that-trigger-workflows#external-events-repository_dispatch\">repository_dispatch</a>\n</li>\n<li>Keep everything together in one place üòâ</li>\n</ul>\n\n<p>Follow these simple steps to setup GitHub actions for your website.</p>\n\n<h3>\n  <a name=\"1-generate-keys\" href=\"#1-generate-keys\" class=\"anchor\">\n  </a>\n  1. Generate Keys\n</h3>\n\n<p>Execute below command in your PC to get all keys.<br>\n</p>\n\n<div class=\"highlight\"><pre class=\"highlight batchfile\"><code><span class=\"kd\">ssh</span><span class=\"na\">-keygen -t </span><span class=\"kd\">rsa</span> <span class=\"na\">-b </span><span class=\"m\">4096</span> <span class=\"na\">-C </span><span class=\"s2\">\"$(git config user.email)\"</span> <span class=\"na\">-f </span><span class=\"kd\">gh</span><span class=\"na\">-pages -N </span><span class=\"s2\">\"\"</span>\n</code></pre></div>\n\n\n<p>Two files named <code>gh-pages</code> (private key) and <code>gh-pages.pub</code> (public key) will be generated.</p>\n\n<p><strong>DON'T PUSH THOSE GENERATED KEY FILES IN ANY GIT REPOSITORY</strong>. You can delete them after you added the credentials to GitHub.</p>\n<h3>\n  <a name=\"2-add-deploy-key\" href=\"#2-add-deploy-key\" class=\"anchor\">\n  </a>\n  2. Add Deploy Key\n</h3>\n\n<p>You need to add a deploy key for deploying the branch content to the web.</p>\n\n<ul>\n<li>Copy the contents of the <code>gh-pages.pub</code> file.</li>\n<li>Goto <strong>Settings</strong> of your repository.</li>\n<li>Goto <strong>Deploy Keys</strong> settings.</li>\n<li>Give <strong>Title</strong> as <strong>ACTIONS_DEPLOY_KEY</strong>\n</li>\n<li>Paste key contents in <strong>Key</strong> field.</li>\n<li>Check <strong>Allow write access</strong> option.</li>\n<li>Click <strong>Add key</strong>.</li>\n</ul>\n<h3>\n  <a name=\"3-add-secret-key\" href=\"#3-add-secret-key\" class=\"anchor\">\n  </a>\n  3. Add Secret Key\n</h3>\n\n<p>And you need to add a secret key also.</p>\n\n<ul>\n<li>Copy the contents of <code>gh-pages</code> file.</li>\n<li>Goto <strong>Settings</strong> of your repository.</li>\n<li>Goto <strong>Secrets</strong> settings.</li>\n<li>Click <strong>Add new secret</strong>.</li>\n<li>Give <strong>Name</strong> as <strong>ACTIONS_DEPLOY_KEY</strong>\n</li>\n<li>Paste key contents in <strong>Value</strong> field.</li>\n<li>Click <strong>Add secret</strong>.</li>\n</ul>\n<h3>\n  <a name=\"3-personal-access-token\" href=\"#3-personal-access-token\" class=\"anchor\">\n  </a>\n  3. Personal Access Token\n</h3>\n\n<p>If you already have a token with <code>repo</code> access, we can use that. Or create one with <code>repo</code> access from <a href=\"https://github.com/settings/tokens/new\">settings</a><br>\nYou can use this token to trigger <code>repository_dispatch</code> events.<br>\n<a href=\"https://res.cloudinary.com/practicaldev/image/fetch/s--oVf-P8C7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/yyq0nv5987k3x08jtynu.png\" class=\"article-body-image-wrapper\"><img src=\"https://res.cloudinary.com/practicaldev/image/fetch/s--oVf-P8C7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/i/yyq0nv5987k3x08jtynu.png\" alt=\"New personal access token\" loading=\"lazy\"></a></p>\n<h3>\n  <a name=\"5-workflow\" href=\"#5-workflow\" class=\"anchor\">\n  </a>\n  5. Workflow\n</h3>\n\n<p>Create a file <code>github-deploy.yml</code> with the following content in <code>.github/workflows</code> location in the root folder of your repository.<br>\n</p>\n<div class=\"highlight\"><pre class=\"highlight yaml\"><code><span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Github Deploy</span>\n\n<span class=\"na\">on</span><span class=\"pi\">:</span>\n  <span class=\"na\">repository_dispatch</span><span class=\"pi\">:</span>\n  <span class=\"na\">push</span><span class=\"pi\">:</span>\n    <span class=\"na\">branches</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"s\">master</span>\n\n<span class=\"na\">jobs</span><span class=\"pi\">:</span>\n  <span class=\"na\">deploy</span><span class=\"pi\">:</span>\n    <span class=\"na\">runs-on</span><span class=\"pi\">:</span> <span class=\"s\">ubuntu-18.04</span>\n    <span class=\"na\">steps</span><span class=\"pi\">:</span>\n      <span class=\"pi\">-</span> <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/checkout@v2</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Setup node</span>\n        <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/setup-node@v1</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">node-version</span><span class=\"pi\">:</span> <span class=\"s1\">'</span><span class=\"s\">10.x'</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Get yarn cache</span>\n        <span class=\"na\">id</span><span class=\"pi\">:</span> <span class=\"s\">yarn-cache</span>\n        <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">echo \"::set-output name=dir::$(yarn cache dir)\"</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Cache dependencies</span>\n        <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">actions/cache@v1</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">path</span><span class=\"pi\">:</span> <span class=\"s\">${{ steps.yarn-cache.outputs.dir }}</span>\n          <span class=\"na\">key</span><span class=\"pi\">:</span> <span class=\"s\">${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}</span>\n          <span class=\"na\">restore-keys</span><span class=\"pi\">:</span> <span class=\"pi\">|</span>\n            <span class=\"s\">${{ runner.os }}-yarn-</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">yarn install</span>\n      <span class=\"pi\">-</span> <span class=\"na\">run</span><span class=\"pi\">:</span> <span class=\"s\">yarn build</span>\n\n      <span class=\"pi\">-</span> <span class=\"na\">name</span><span class=\"pi\">:</span> <span class=\"s\">Deploy</span>\n        <span class=\"na\">uses</span><span class=\"pi\">:</span> <span class=\"s\">peaceiris/actions-gh-pages@v3</span>\n        <span class=\"na\">with</span><span class=\"pi\">:</span>\n          <span class=\"na\">deploy_key</span><span class=\"pi\">:</span> <span class=\"s\">${{ secrets.ACTIONS_DEPLOY_KEY }}</span>\n          <span class=\"na\">publish_dir</span><span class=\"pi\">:</span> <span class=\"s\">./public</span>\n\n</code></pre></div>\n\n\n<p>According to the <code>github-deploy.yml</code> file, GitHub action will execute <code>yarn build</code> followed by <code>yarn install</code> and publish the contents of <code>/public</code> folder into <code>gh-pages</code> branch in your repository whenever there is a new push event happens in <code>master</code> branch or whenever a <code>repository_dispatch</code> event is fired. After the first build, you can goto <strong>Settings</strong> page of your repository and select <strong>gh-pages</strong> from <strong>Source</strong> dropdown in <strong>GitHub Pages</strong> section.</p>\n\n<p>Don't forget to link your domain with GitHub pages. For that add a <code>CNAME</code> file with your domain name in the <code>/static</code> folder of your gatsby project. </p>\n\n<p>You can read more about how I link my domain &amp; subdomains with GitHub <a href=\"https://chandujs.dev/blog/wildcard-subdomains-github-pages-38fh\">here</a></p>\n\n\n<div class=\"ltag__link\">\n  <a href=\"/ctrleffive\" class=\"ltag__link__link\">\n    <div class=\"ltag__link__pic\">\n      <img src=\"https://res.cloudinary.com/practicaldev/image/fetch/s--1GMLvIIy--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://res.cloudinary.com/practicaldev/image/fetch/s--LKcmzzhL--/c_fill%2Cf_auto%2Cfl_progressive%2Ch_150%2Cq_auto%2Cw_150/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/61261/7d63301a-4388-4a48-937b-3e9a2ba3181d.jpg\" alt=\"ctrleffive image\" loading=\"lazy\">\n    </div>\n  </a>\n  <a href=\"/ctrleffive/wildcard-subdomains-github-pages-38fh\" class=\"ltag__link__link\">\n    <div class=\"ltag__link__content\">\n      <h2>üî• Wildcard Subdomains &amp; GitHub Pages</h2>\n      <h3>Chandu J S „Éª Apr  5 „Éª 2 min read</h3>\n      <div class=\"ltag__link__taglist\">\n        <span class=\"ltag__link__tag\">#github</span>\n        <span class=\"ltag__link__tag\">#webdev</span>\n        <span class=\"ltag__link__tag\">#dns</span>\n      </div>\n    </div>\n  </a>\n</div>\n\n\n\n","url":"https://dev.to/ctrleffive/static-website-hosting-with-github-actions-4g0d","cover_image":null}}},"pageContext":{"slug":"static-website-hosting-with-github-actions-4g0d"}},"staticQueryHashes":["1617812919"]}